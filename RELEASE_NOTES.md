# Network Profile Switcher - リリースノート

## v1.0.1 (最新) - 2025年8月

### 🎉 新機能・改善

#### 🔧 LANケーブル未接続対応
- **自動アダプタ有効化機能**
  - アダプタがDown状態の場合、自動的に有効化を試行
  - 有効化後、状態を再確認してから設定を適用
  - 物理的な接続問題の詳細な情報提供

- **改善されたエラーメッセージ**
  - LANケーブル未接続時の具体的な対処方法を提示
  - アダプタの詳細情報（速度、MACアドレス等）を表示
  - より分かりやすいエラー情報の提供

#### 🛠️ 文字化け対策
- **複数エンコーディング対応**
  - Shift_JISとUTF-8の両方のエンコーディングを試行
  - netshコマンド出力の文字化け問題を解決
  - 文字化けが発生しても機能に影響しないよう改善

- **エンコーディング自動検出**
  - 複数のエンコーディング方式を自動的に試行
  - 最も適切なエンコーディングを自動選択
  - 文字化けの原因となるエンコーディング問題を根本的に解決

#### 📊 アダプタ詳細情報機能
- **詳細情報の表示**
  - アダプタ名、説明、状態、種類の詳細表示
  - 速度、MACアドレスの情報提供
  - 物理的な接続状態の確認機能

- **エラー時の詳細情報**
  - エラー発生時にアダプタの詳細情報を表示
  - 問題の原因特定を支援する情報提供
  - トラブルシューティングの効率化

### 🐛 修正された問題

#### LANケーブル未接続関連
- **アダプタがDown状態の場合のエラー処理**
  - 自動的なアダプタ有効化試行機能を追加
  - 物理的な接続問題の詳細な情報提供
  - ユーザーフレンドリーなエラーメッセージの改善

#### 文字化け問題
- **netshコマンド出力の文字化け**
  - 複数エンコーディング方式の自動試行
  - Shift_JISとUTF-8の両方に対応
  - 文字化けが発生しても機能に影響しない改善

## v1.0.0 - 2025年8月

### 🎉 新機能・改善

#### 🔧 DHCP設定の大幅改善
- **「DHCP is already enabled」エラーの適切な処理**
  - DHCPが既に有効な場合のエラーメッセージを正常な状態として認識
  - ユーザーに混乱を与えない適切なエラーハンドリング

- **WMIフォールバック機能**
  - netshコマンドが失敗した場合、自動的にWMIを使用
  - Realtek PCIe GbE等のアダプタでのDHCP設定成功率向上
  - より詳細なエラー情報の提供

#### 🛠️ エラーハンドリング強化
- **System.Managementアセンブリエラーの詳細対応**
  - .NET 6.0 Runtime不足時の適切なエラーメッセージ
  - 解決方法の具体的な提示
  - Visual C++ 再頒布可能パッケージの案内

- **包括的な例外処理**
  - アダプタ固有の問題への対応
  - より詳細なエラー情報の表示
  - ユーザーフレンドリーなエラーメッセージ

#### 📦 実行ファイル最適化
- **最小構成の実現**
  - 不要なファイルの削除（System.CodeDom.dll等）
  - 実行ファイルサイズの最適化（約1.3MB）
  - 必要な依存関係のみを含む構成

### 🐛 修正された問題

#### DHCP設定関連
- **Realtek PCIe GbE Family ControllerでのDHCP設定失敗**
  - 「DHCP is already enabled」メッセージの適切な処理
  - WMIフォールバック機能による成功率向上

- **System.Managementアセンブリエラー**
  - .NET 6.0 Runtime不足時の詳細なエラー情報
  - 解決方法の具体的な案内